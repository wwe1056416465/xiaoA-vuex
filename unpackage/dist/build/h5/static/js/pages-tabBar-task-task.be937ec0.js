(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-tabBar-task-task"],{"08d4":function(t,a,e){"use strict";var i=e("af6f"),s=e.n(i);s.a},"11d6":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=r(e("ea99")),s=r(e("485a")),n=(r(e("9dcb")),r(e("4380"))),o=r(e("84e6"));function r(t){return t&&t.__esModule?t:{default:t}}var d={components:{mixPulldownRefresh:i.default,mixLoadMore:s.default,popupLayer:n.default},data:function(){return{list:[],loadMoreStatus:0,page:1,sign:"",requestData:"",taskId:"",taskPage:"task",direction:"top"}},onShow:function(){this.requestData=JSON.stringify(this.$store.state.taskForm);try{var t=uni.getStorageSync("sign"),a=uni.getStorageSync("addtask");uni.removeStorageSync("addtask"),this.sign=t,"tasksearch"!==this.sign&&"ok"!=a||(this.list=[],this.page=1),this.loadData("add")}catch(e){}},onNavigationBarButtonTap:function(t){uni.navigateTo({url:"/pages/task/taskSearch"})},onHide:function(){this.$refs.popup.close();try{uni.removeStorageSync("sign"),this.$store.commit("clearTask")}catch(t){}},onReachBottom:function(){this.loadData("add")},methods:{caozuo:function(t){var a=this,e=uni.getStorageSync("taskId");"del"===t?this.list.some(function(t,i){t.id==e&&a.list.splice(i,1)}):this.list.map(function(a){a.id==e&&(a.status=t)})},loadData:function(t){var a=this;"add"===t&&(this.loadMoreStatus=1),setTimeout(function(){"refresh"===t&&(a.list=[],a.page=1);var e={page:a.page,limit:5,data:a.requestData,access_token:a.$store.state.token};(0,o.default)("/adminspa/marketing/index.html",e).then(function(t){if(1001!=t.data.code){a.page++;for(var e=0;e<t.data.data.length;e++){var i=t.data.data[e].completed/t.data.data[e].total;i*=100,i=i.toFixed(0),t.data.data[e].percent=i}t.data.data.length<5&&(a.loadMoreStatus=2),a.list=a.list.concat(t.data.data)}else uni.navigateTo({url:"/pages/login/login"})}),"add"===t&&(a.loadMoreStatus=0),"refresh"===t&&(a.$refs.mixPulldownRefresh&&a.$refs.mixPulldownRefresh.endPulldownRefresh(),a.loadMoreStatus=0)},500)},task_add:function(){uni.navigateTo({url:"/pages/task/addtask"})},task_scerch:function(){uni.navigateTo({url:"/pages/task/taskSearch"})},caozuobtn:function(t){var a=t.target.dataset.type;uni.setStorageSync("tasktype",a)},showTip:function(t,a,e){this.$refs.popup.show(),this.taskId=String(t);var i=String(a),s=String(e);uni.setStorageSync("taskId",this.taskId),uni.setStorageSync("taskStatus",i),uni.setStorageSync("taskFail",s)},onPulldownReresh:function(){this.loadData("refresh")}}};a.default=d},"193e":function(t,a,e){var i=e("b041");a=t.exports=e("2350")(!1),a.push([t.i,".content[data-v-9fd9e520],body.pages-tabBar-crm-crm uni-page-body[data-v-9fd9e520]{background-color:#fff!important}.content[data-v-9fd9e520],uni-page-body[data-v-9fd9e520]{background-color:#f8f8f8}.newslist[data-v-9fd9e520]{padding:10px;line-height:60px;font-size:28px}.loading[data-v-9fd9e520]{text-align:center;line-height:80px}.task_block[data-v-9fd9e520]{padding:5px 10px;color:#404040;font-family:Helvetica Neue,Helvetica,sans-serif}.space10[data-v-9fd9e520]{height:10px;background-color:#f5f5f5}.task_title[data-v-9fd9e520]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;border-bottom:1px solid #f3f5f7;padding:6px 0;font-size:14px}.task[data-v-9fd9e520]{padding:5px 0}uni-view[data-v-9fd9e520]{font-size:12px;color:#5e6871}.task_title .text[data-v-9fd9e520]{font-size:14px;color:#404040}.jindutiao[data-v-9fd9e520]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-top:10px}.tip[data-v-9fd9e520]{width:82px;text-align:right;color:#000;font-size:13px;margin-right:10px}.progress-box[data-v-9fd9e520]{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;margin-top:8px}.task_con uni-view[data-v-9fd9e520]{margin:5px 0}.task_suess[data-v-9fd9e520]{padding:1px 8px;color:#fff;width:50px;height:22px;line-height:22px;text-align:center;border-radius:5px;font-size:10px}.uni-progress[data-v-9fd9e520]{border-radius:10px}@font-face{font-family:iconfont;src:url("+i(e("dd13"))+') format("truetype")}.addTack[data-v-9fd9e520]{text-align:center;position:fixed;right:5%;bottom:100px;z-index:999}.addTack.scerch[data-v-9fd9e520]{bottom:300px}.addTack.scerch .task_scerch[data-v-9fd9e520]{font-family:iconfont;margin-left:%?20?%;width:50px;text-align:center;background-color:#3690ff;height:50px;line-height:50px;border-radius:50%;font-size:20px;background:#3690ff;-webkit-box-shadow:2px 9px 16px rgba(0,0,0,.15);box-shadow:2px 9px 16px rgba(0,0,0,.15);color:#fff}.task_add[data-v-9fd9e520]{width:50px;text-align:center;background-color:#3690ff;height:50px;line-height:50px;border-radius:50%;font-size:25px;background:#3690ff;-webkit-box-shadow:2px 9px 16px rgba(0,0,0,.15);box-shadow:2px 9px 16px rgba(0,0,0,.15);color:#fff}.zidingyi[data-v-9fd9e520]{padding:0 10px}.zidingyi uni-button[data-v-9fd9e520]:after{border:0}.popup-content[data-v-9fd9e520]{background:none!important}.zidingyi uni-button[data-v-9fd9e520]{padding:%?16?% 0;font-size:%?18?%;border-radius:0;border-bottom:1px solid #eee}.bg_blue[data-v-9fd9e520]{background-color:#3690ff}.bg_stop[data-v-9fd9e520]{background-color:#ffa748}.bg_start[data-v-9fd9e520]{background-color:#ffb800}.bg_complete[data-v-9fd9e520]{color:#fff;background-color:#75cd00}.taskList[data-v-9fd9e520]{background-color:#fff}body.?%PAGE?%[data-v-9fd9e520]{background-color:#f8f8f8}',""])},"3a84":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i={name:"popup-layer",props:{direction:{type:String,default:"top"},page:{type:String,default:""}},data:function(){return{ifshow:!1,translateValue:-100,timer:null,iftoggle:!1}},computed:{_translate:function(){var t={top:"transform:translateY(".concat(-this.translateValue,"%)"),bottom:"transform:translateY(".concat(this.translateValue,"%)"),left:"transform:translateX(".concat(-this.translateValue,"%)"),right:"transform:translateX(".concat(this.translateValue,"%)")};return t[this.direction]},_location:function(){var t={top:"bottom:0px;width:100%;",bottom:"top:0px;width:100%;",left:"right:0px;height:100%;",right:"left:0px;height:100%;"};return t[this.direction]+this._translate}},methods:{show:function(){var t=this;this.ifshow=!0;setTimeout(function(){t.translateValue=0,null},100),setTimeout(function(){t.iftoggle=!0,null},300)},close:function(){var t=this;null===this.timer&&this.iftoggle&&(this.translateValue=-100,this.timer=setTimeout(function(){t.ifshow=!1,t.timer=null,t.iftoggle=!1},300))},stopEvent:function(t){var a=this;console.log(t,"ok");var e=uni.getStorageSync("taskId"),i=uni.getStorageSync("tasktype"),s=uni.getStorageSync("taskStatus"),n=uni.getStorageSync("taskFail");if(console.log(e),"analyze"==i)console.log("dssdsddsds"),uni.navigateTo({url:"/pages/task/task?id="+e});else if("stop"==i){if(2!=s)return this.ifshow=!1,uni.showToast({title:"该操作只针对正在运行的任务",icon:"none",duration:2e3}),!1;uni.request({url:this.$url+"adminspa/marketing/stop.html?d"+Math.random(),method:"POST",async:!0,header:{"Content-Type":"application/x-www-form-urlencoded",charset:"utf-8","X-Requested-With":"XMLhttpRequest"},data:{id:e,access_token:this.$store.state.token},success:function(t){a.$emit("caozuo","3"),uni.setStorageSync("taskStatus","3"),a.ifshow=!1}})}else if("continue"==i){if(3!=s)return this.ifshow=!1,uni.showToast({title:"该操作只针对暂停发送的任务",icon:"none",duration:2e3}),!1;uni.request({url:this.$url+"adminspa/marketing/restart.html",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",charset:"utf-8","X-Requested-With":"XMLhttpRequest"},data:{id:e,access_token:this.$store.state.token},success:function(t){a.$emit("caozuo","2"),uni.setStorageSync("taskStatus","2"),a.ifshow=!1}})}else if("failCall"==i){if(0===n)return this.ifshow=!1,uni.showToast({title:"该操作只针对呼叫失败的任务",icon:"none",duration:2e3}),!1;uni.request({url:this.$url+"adminspa/marketing/recall.html",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",charset:"utf-8","X-Requested-With":"XMLhttpRequest"},data:{id:e,access_token:this.$store.state.token},success:function(t){a.$emit("caozuo","2"),uni.setStorageSync("taskStatus","2"),a.ifshow=!1}})}else if("delete"==i){var o=[];o.push(e),uni.request({url:this.$url+"adminspa/marketing/deletem.html",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",charset:"utf-8","X-Requested-With":"XMLhttpRequest"},data:{"id[]":o,access_token:this.$store.state.token},success:function(t){a.$emit("caozuo","del"),a.ifshow=!1}})}else"cancel"==i&&(this.ifshow=!1)}}};a.default=i},"3dd2":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticClass:"content"},[e("mix-pulldown-refresh",{ref:"mixPulldownRefresh",attrs:{top:0},on:{refresh:function(a){a=t.$handleEvent(a),t.onPulldownReresh(a)}}},[e("v-uni-view",{staticClass:"scroll-wrapper"},[t._l(t.list,function(a,i){return e("v-uni-view",{key:i,staticClass:"taskList"},[e("v-uni-view",{staticClass:"task_block",on:{click:function(e){e=t.$handleEvent(e),t.showTip(a.id,a.status,a.failurenum)}}},[e("v-uni-view",{staticClass:"task_title"},[e("v-uni-view",{staticClass:"text"},[t._v(t._s(a.jobname))]),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:1==a.status,expression:"item.status == 1"}],staticClass:"task_suess bg_stop"},[t._v("待启动")]),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:2==a.status,expression:"item.status == 2"}],staticClass:"task_suess bg_blue"},[t._v("正在发送")]),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:3==a.status,expression:"item.status == 3"}],staticClass:"task_suess bg_start"},[t._v("暂停发送")]),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:4==a.status,expression:"item.status == 4"}],staticClass:"task_suess bg_complete"},[t._v("发送完成")])],1),e("v-uni-view",{staticClass:"jindutiao"},[e("v-uni-view",{staticClass:"progress-box"},[e("v-uni-progress",{staticStyle:{"border-radius":"10px"},attrs:{percent:a.percent,activeColor:"#3690FF",active:"","stroke-width":"5"}})],1),e("v-uni-view",{staticClass:"tip"},[t._v("进度"),e("v-uni-text",[t._v(t._s(a.completed)+"/"+t._s(a.total))])],1)],1),e("v-uni-view",{staticClass:"task_con"},[e("v-uni-view",{staticClass:"starttime"},[e("v-uni-text",[t._v("开始时间 ：")]),e("v-uni-text",[t._v(t._s(a.createddate||"----"))])],1),e("v-uni-view",{staticClass:"endtime"},[e("v-uni-text",[t._v("结束时间 ：")]),e("v-uni-text",[t._v(t._s(a.finishtime||"----"))])],1),e("v-uni-view",{staticClass:"user"},[e("v-uni-text",[t._v("创建人 ：")]),e("v-uni-text",[t._v(t._s(a.createdby))])],1),e("v-uni-view",{staticClass:"child"},[e("v-uni-text",[t._v("子账号 ：")]),e("v-uni-text",[t._v(t._s(a.contactsuffix))])],1)],1)],1),e("v-uni-view",{staticClass:"space10"})],1)}),e("mix-load-more",{attrs:{status:t.loadMoreStatus}})],2)],1),e("v-uni-view",{staticClass:"addTack"},[e("v-uni-view",{staticClass:"task_add",on:{click:function(a){a=t.$handleEvent(a),t.task_add(a)}}},[t._v("+")])],1),e("popup-layer",{ref:"popup",attrs:{direction:t.direction,page:t.taskPage},on:{caozuo:function(a){a=t.$handleEvent(a),t.caozuo(a)}}},[e("v-uni-view",{staticClass:"zidingyi"},[e("v-uni-button",{staticClass:"caozuobtn",attrs:{"data-type":"analyze","data-id":t.taskId},on:{click:function(a){a=t.$handleEvent(a),t.caozuobtn(a)}}},[t._v("任务分析")]),e("v-uni-button",{staticClass:"caozuobtn",attrs:{"data-type":"stop","data-id":t.taskId},on:{click:function(a){a=t.$handleEvent(a),t.caozuobtn(a)}}},[t._v("暂停任务")]),e("v-uni-button",{staticClass:"caozuobtn",attrs:{"data-type":"continue","data-id":t.taskId},on:{click:function(a){a=t.$handleEvent(a),t.caozuobtn(a)}}},[t._v("继续任务")]),e("v-uni-button",{staticClass:"caozuobtn",attrs:{"data-type":"failCall","data-id":t.taskId},on:{click:function(a){a=t.$handleEvent(a),t.caozuobtn(a)}}},[t._v("失败重呼")]),e("v-uni-button",{staticClass:"caozuobtn",staticStyle:{color:"red"},attrs:{"data-type":"delete","data-id":t.taskId},on:{click:function(a){a=t.$handleEvent(a),t.caozuobtn(a)}}},[t._v("删除任务")]),e("v-uni-button",{staticClass:"caozuobtn",staticStyle:{margin:"10px 0",color:"#09BB07"},attrs:{"data-type":"cancel"},on:{click:function(a){a=t.$handleEvent(a),t.caozuobtn(a)}}},[t._v("取消")])],1)],1)],1)},s=[];e.d(a,"a",function(){return i}),e.d(a,"b",function(){return s})},4311:function(t,a,e){"use strict";e.r(a);var i=e("11d6"),s=e.n(i);for(var n in i)"default"!==n&&function(t){e.d(a,t,function(){return i[t]})}(n);a["default"]=s.a},4380:function(t,a,e){"use strict";e.r(a);var i=e("d0ec"),s=e("f438");for(var n in s)"default"!==n&&function(t){e.d(a,t,function(){return s[t]})}(n);e("08d4");var o=e("2877"),r=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,"e325e89e",null);a["default"]=r.exports},"534e":function(t,a,e){"use strict";e.r(a);var i=e("3dd2"),s=e("4311");for(var n in s)"default"!==n&&function(t){e.d(a,t,function(){return s[t]})}(n);e("b687");var o=e("2877"),r=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,"9fd9e520",null);a["default"]=r.exports},"836f":function(t,a,e){var i=e("193e");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=e("4f06").default;s("0b15a4d2",i,!0,{sourceMap:!1,shadowMode:!1})},"8ff8":function(t,a,e){a=t.exports=e("2350")(!1),a.push([t.i,".popup-layer[data-v-e325e89e]{position:fixed;z-index:999999;background:rgba(0,0,0,.3);height:100%;width:100%;top:0;left:0}.popup-content[data-v-e325e89e]{position:fixed;z-index:1000000;background:#fff;max-height:60%;overflow-y:auto;-webkit-transition:all .3s ease;-o-transition:all .3s ease;transition:all .3s ease}uni-button[data-v-e325e89e]:after{border:none}.task[data-v-e325e89e]{background:none}",""])},af6f:function(t,a,e){var i=e("8ff8");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=e("4f06").default;s("470f0b74",i,!0,{sourceMap:!1,shadowMode:!1})},b687:function(t,a,e){"use strict";var i=e("836f"),s=e.n(i);s.a},d0ec:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.ifshow,expression:"ifshow"}],staticClass:"popup-layer",on:{click:function(a){a=t.$handleEvent(a),t.close(a)}}},[e("v-uni-view",{ref:"popRef",staticClass:"popup-content",class:{task:"task"==t.page},style:t._location,on:{click:function(a){a.stopPropagation(),a=t.$handleEvent(a),t.stopEvent(a)}}},[t._t("default")],2)],1)},s=[];e.d(a,"a",function(){return i}),e.d(a,"b",function(){return s})},f438:function(t,a,e){"use strict";e.r(a);var i=e("3a84"),s=e.n(i);for(var n in i)"default"!==n&&function(t){e.d(a,t,function(){return i[t]})}(n);a["default"]=s.a}}]);